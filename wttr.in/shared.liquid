<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,200,0,0" rel="stylesheet">

<style>
  .material-symbols-outlined {
    font-family: 'Material Symbols Outlined';
    font-weight: normal;
    font-style: normal;
    font-size: 24px;
    line-height: 1;
    letter-spacing: normal;
    text-transform: none;
    display: inline-block;
    white-space: nowrap;
    word-wrap: normal;
    direction: ltr;
    -webkit-font-feature-settings: 'liga';
    -webkit-font-smoothing: antialiased;
  }
  .weather-icon-large {
    font-size: 60px;
  }
  .timelabel {
    text-align: center;
    display: block;
    break-after: always;
    font-weight: bold;
  }
  .daylabel {
    text-align: center;
    margin-bottom: -20px;
    padding: 2px;
    border: solid;
    border-width: 1px;
  }
  .label {
    line-height: 78%;
  }
</style>

{% template weather_icon %}
<span class="material-symbols-outlined weather-icon-large">
  {% case status %}
  {% when 'clear_day' %}wb_sunny
  {% when 'Sunny' %}wb_sunny
  {% when 'Clear ' %}wb_sunny
  {% when 'clear_night' %}dark_mode
  {% when 'partly_cloudy_day' %}partly_cloudy_day
  {% when 'Partly cloudy' %}partly_cloudy_day
  {% when 'Partly Cloudy ' %}partly_cloudy_day
  {% when 'partly_cloudy_night' %}nights_stay
  {% when 'cloudy' %}cloud
  {% when 'Overcast ' %}cloud
  {% when 'Cloudy ' %}cloud
  {% when 'rainy' %}rainy
  {% when 'Shower in vicinity' %}rainy
  {% when 'Light rain shower' %}rainy
  {% when 'Patchy rain nearby' %}rainy
  {% when 'Moderate rain' %}rainy
  {% when 'Rain shower' %}rainy
  {% when 'rainy' %}rainy
  {% when 'thunderstorm' %}thunderstorm
  {% when 'Thundery outbreaks in nearby' %}thunderstorm
  {% when 'bolt' %}bolt
  {% when 'snowy' %}cloudy_snowing
  {% when 'foggy' %}foggy
  {% when 'error' %}error
  {% else %}device_unknown
  {% endcase %}
</span>
{% endtemplate %}

{% template wind %}
{% case dir %}
{% when 'NNW' %}↘
{% when 'NNE' %}↙
{% when 'WNW' %}↘
{% when 'ENE' %}↙
{% when 'SSW' %}↗
{% when 'SSE' %}↖
{% when 'WSW' %}↗
{% when 'ESE' %}↖
{% when 'NW' %}↘
{% when 'NE' %}↙
{% when 'SW' %}↗
{% when 'SE' %}↖
{% when 'N' %}↓
{% when 'S' %}↑
{% when 'E' %}←
{% when 'W' %}→
{% else %}.
{% endcase %}
{% endtemplate %}

{% template condition %}
{% if trmnl.plugin_settings.custom_fields_values.measurements == "metric" %}
  {% assign metric = true %}
{% endif %}

{% assign temp = data.tempF %}
{% assign feelslike = data.FeelsLikeF %}
{% assign tempmeasure = 'F' %}
{% assign ws = data.windspeedMiles|append: "-"|append: data.WindGustMiles | append: " mph" %}
{% assign vis = data.visibilityMiles | append: " mi" %}
{% assign precip = data.precipInches | append: " in " %}
{% assign precipPct = data.chanceofrain | prepend: "| " | append: "%" %}
{% assign stretch = "stretch-x" %}

{% if metric %}
  {% assign temp = data.tempC %}
  {% assign feelslike = data.FeelsLikeC %}
  {% assign tempmeasure = 'C' %}
  {% assign ws = data.windspeedKmph | append: "-" | append: data.WindGustKmph | append: " km/h"| %}
  {% assign vis = data.visibility | append: " km" %}
  {% assign precip = data.precipMM | append: " mm " %}
{% endif %}

{% if current %}
  {% assign temp = data.temp_F %}
  {% assign ws = data.windspeedMiles | append: " mph" %}
  {% assign precipPct = "" %}
  {% assign stretch = "" %}
  {% if metric %}
    {% assign temp = data.temp_C %}
    {% assign ws = data.windspeedKmph | append: " km\h" %}
  {% endif %}
{% endif %}

{% if temp == feelslike %}
  {% assign fulltemp = temp | append: " °" | append: tempmeasure %}
{% else %}
  {% assign fulltemp = temp | append: "(" | append: feelslike | append: ") °" | append: tempmeasure %}
{% endif %}

<div class="{{ stretch }}">
  <div class="label label--small timelabel">{{ timelabel }}</div>
  <div class="item">{% render "weather_icon", status: data.weatherDesc[0].value %}
    <div class="{{ stretch }}">
      <span class="label label--small clamp--1">{{ data.weatherDesc[0].value }}</span><br>
      <span class="label label--small">{{ fulltemp }}</span><br>
      <span class="label label--small">{% render "wind", dir: data.winddir16Point %} {{ ws }}</span><br>
      <span class="label label--small">{{ vis }}</span><br>
      <span class="label label--small">{{ precip | append: precipPct }}</span><br>
    </div>
  </div>
</div>
{% endtemplate %}

{% template day %}
<div class="daylabel label label--small">{{ day_struct.date | date: "%a %d %b" }}</div>
<div class="flex flex--row stretch-x">
  {% render "condition", data: day_struct.hourly[3], timelabel: "Morning", trmnl: trmnl %}
  {% render "condition", data: day_struct.hourly[4], timelabel: "Noon", trmnl: trmnl %}
  {% render "condition", data: day_struct.hourly[6], timelabel: "Evening", trmnl: trmnl %}
  {% render "condition", data: day_struct.hourly[7], timelabel: "Night", trmnl: trmnl %}
</div>

{% endtemplate %}